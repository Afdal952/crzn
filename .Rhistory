color: #ffffff; /* Warna teks sidebar */
}
#cluster_map {
height: 1000px; /* Atur tinggi peta sesuai preferensi */
border-radius: 10px; /* Atur border radius peta */
}
.main-header .logo {
background-color: #4b0082 !important; /* Warna background logo header */
}
.main-header .logo:hover {
background-color: #2e0854 !important; /* Warna background logo header saat hover */
}
.main-header .navbar {
background-color: #6a5acd !important; /* Warna background navbar header */
}
.content-wrapper, .right-side {
background-color: #ffffff; /* Warna background konten utama */
}
.box.box-primary {
border-top-color: #6a5acd;
}
.box.box-solid.box-info {
border: 1px solid #d2d6de;
}
.box.box-solid.box-primary>.box-header {
color: #fff;
background: #3c8dbc;
background-color: #6a5acd;
text-align: center;
}
.box-header .box-title, .box-header>.fa, .box-header>.glyphicon, .box-header>.ion {
display: flex;
font-size: 18px;
margin: 0;
font-family: Verdana;
}
.info-box-icon.bg-ungu {
background: linear-gradient(to right, #6a5acd, #836FFF); /* Gradient ungu */
}
.alert-info, .bg-aqua, .callout.callout-info, .label-info, .modal-info .modal-body {
background-color: #9b28b7!important;
border-radius: 5px;
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.box.box-solid.box-info>.box-header {
color: #fff;
background: purple;
background-color: slateblue;
}
.cluster-characteristics-title {
background-color: lightgray;
padding: 10px;
margin-bottom: 20px;
border-radius: 10px;
box-shadow: 0 2px 5px rgba(0,0,0,0.1);
font-size: 18px;
font-weight: bold;
width: fit-content;
margin-left: 25%;
}
.info-box-text, .progress-description {
display: block;
font-size: 13px;
overflow: hidden;
text-overflow: ellipsis;
text-wrap: balance;
}
.col-sm-6 {
width: 50%;
}
.dataTables_wrapper {
position: relative;
clear: both;
margin-top: 10px;
}
.h3, h3 {
font-size: 20px;
font-weight: 800;
text-align: center;
margin: 0px 0px 10px;
}
.info-box-content {
padding: 20px 10px 0px 10px;
margin-left: 90px;
}
.cluster-regression-info {
font-family: Verdana;
font-size: 11px;
font-weight: 200;
text-align: justify;
padding: 12px;
background-color: #d3d3d3;
margin-right: 30px;
}
"))
),
fluidRow(
box(
width = 12,
title = "Data Exploration",
status = "primary",
solidHeader = TRUE,
tabsetPanel(
id = "data_exploration",
tabPanel("Map", leafletOutput(outputId = "cluster_map")),
tabPanel("Table", DTOutput(outputId = "cluster_table")),
tabPanel("Chart", plotOutput(outputId = "plot_output"))
)
)
),
fluidRow(
column(
width = 6,
uiOutput("cluster_title_ui"),
uiOutput("cluster_characteristics")
),
column(
width = 6,
uiOutput("cluster_regression")
)
)
)
)
)
server <- function(input, output, session) {
# Filtered Data
data_filtered <- reactive({
req(input$cluster_selection)
if (input$cluster_selection == "all") {
filtered_data <- dat_map
} else {
filtered_data <- dat_map[dat_map$cluster == as.integer(substring(input$cluster_selection, 9)), ]
}
filtered_data
})
# Display Cluster Title
# Run K-Means
clustering_data <- data_adopsi[, c("Adopsi.TIK","Infrastruktur", "Kapabilitas.Inovasi", "Keterampilan", "Pasar.Tenaga.Kerja", "Stabilitas.Ekonomi", "IRBI")]
# Menambahkan variabel Adopsi.TIK yang sebelumnya dihapus
clustering_data <- data_adopsi %>%
dplyr::select(-Adopsi.TIK) %>%
na.omit() %>%
mutate(cluster = as.factor(kmeans_result$cluster)) %>%
bind_cols(data_adopsi %>% dplyr::select(Adopsi.TIK))
clustering_data = clustering_data[, c("name","cluster","Infrastruktur", "Kapabilitas.Inovasi","Keterampilan","Pasar.Tenaga.Kerja","Stabilitas.Ekonomi","IRBI","Adopsi.TIK")]
output$cluster_title_ui <- renderUI({
if (input$cluster_selection != "all") {
tags$div(class = "cluster-characteristics-title", "Karakteristik Klaster (Rata-Rata)")
} else {
tags$div(class = "cluster-characteristics-title", "Karakteristik Data (Rata-Rata)")
}
})
# Leaflet Map
output$cluster_map <- renderLeaflet({
req(input$cluster_selection)
filtered_data <- data_filtered()
# Create a color palette
palette <- colorFactor(viridis::viridis_pal(option = "plasma")(length(unique(filtered_data$cluster))),
domain = filtered_data$cluster)
# Create the leaflet map
leaflet(data = filtered_data) %>%
addTiles() %>%
addPolygons(fillColor = ~palette(cluster),
color = "white",
weight = 2,
opacity = 1,
fillOpacity = 0.7,
highlightOptions = highlightOptions(
weight = 3,
color = "#666",
fillOpacity = 0.7,
bringToFront = TRUE),
popup = ~paste("Kabupaten:", name, "; Adopsi TIK: ", Adopsi.TIK),
label = ~paste("Kabupaten:", name, "; Adopsi TIK: ", Adopsi.TIK),
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "15px",
direction = "auto")) %>%
addLegend(pal = palette, values = ~cluster, opacity = 0.7, title = "Cluster", position = "bottomright") %>%
setView(lng = 120, lat = -2, zoom = 5)  # Sesuaikan dengan koordinat dan zoom peta yang diinginkan
})
# Render DataTable
output$cluster_table <- renderDT({
if (input$cluster_selection == "all") {
datatable(clustering_data, options = list(pageLength = 10))
} else {
filtered_data <- clustering_data[clustering_data$cluster == as.integer(substring(input$cluster_selection, 9)), ]
datatable(filtered_data, options = list(pageLength = 10))
}
})
# Bar Chart
output$plot_output <- renderPlot({
req(input$cluster_selection)
filtered_data <- data_filtered()
top25 <- filtered_data %>%
arrange(Adopsi.TIK) %>%
head(25)
ggplot(top25, aes(x = reorder(name, Adopsi.TIK), y = Adopsi.TIK, fill = Adopsi.TIK)) +
geom_bar(stat = "identity") +
scale_fill_gradient(low = "#f7f4f9", high = "#6e016b") +
coord_flip() +
labs(title = "25 Kabupaten/Kota dengan Nilai Adopsi TIK Terendah",
x = "Kabupaten/Kota",
y = "Adopsi TIK") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
axis.title.x = element_text(size = 12, face = "bold"),
axis.title.y = element_text(size = 12, face = "bold"))
})
# Characteristic clusters
output$cluster_characteristics <- renderUI({
req(input$cluster_selection)
if (input$cluster_selection == "all") {
cluster_data <- data_filtered()
} else {
cluster_id <- as.integer(substring(input$cluster_selection, 9))
cluster_data <- data_filtered()[data_filtered()$cluster == cluster_id, ]
}
# Select numeric variables except Adopsi.TIK and geometry
numeric_vars <- c("Infrastruktur", "Kapabilitas.Inovasi", "Keterampilan", "Pasar.Tenaga.Kerja", "Stabilitas.Ekonomi", "IRBI")
# Calculate mean of selected variables for the selected cluster
cluster_means <- sapply(cluster_data[, numeric_vars], mean, na.rm = TRUE)
# Add Adopsi.TIK to the cluster_means
cluster_means <- c(cluster_means, Adopsi.TIK = mean(cluster_data$Adopsi.TIK, na.rm = TRUE))
# Create scorecard UI using infoBox
fluidRow(
column(
width = 4,
infoBox(
"Infrastruktur",
round(cluster_means["Infrastruktur"], 2),
icon = icon("cogs"),
width = 12
)
),
column(
width = 4,
infoBox(
"Kapabilitas Inovasi",
round(cluster_means["Kapabilitas.Inovasi"], 2),
icon = icon("lightbulb"),
width = 12
)
),
column(
width = 4,
infoBox(
"Keterampilan",
round(cluster_means["Keterampilan"], 2),
icon = icon("hand-paper"),
width = 12
)
),
column(
width = 4,
infoBox(
"Pasar Tenaga Kerja",
round(cluster_means["Pasar.Tenaga.Kerja"], 2),
icon = icon("users"),
width = 12
)
),
column(
width = 4,
infoBox(
"Stabilitas Ekonomi",
round(cluster_means["Stabilitas.Ekonomi"], 2),
icon = icon("line-chart"),
width = 12
)
),
column(
width = 4,
infoBox(
"Indeks Risiko Bencana",
round(cluster_means["IRBI"], 2),
icon = icon("mountain"),
width = 12
)
)
)
})
output$cluster_regression <- renderUI({
req(input$cluster_selection)
if (input$cluster_selection == "all") {
ui <- fluidRow(
tags$div(
style = "font-family: Verdana; font-size: 13px; font-weight: 400; text-align: justify; padding: 16px;
background-color: #f0f0f0; border-radius: 10px; box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
margin-right: 24px",
tags$h3("Pengenalan Smart City"),
tags$p(
"Smart City adalah konsep kota yang menggunakan teknologi informasi dan komunikasi (TIK) untuk meningkatkan efisiensi operasional, berbagi informasi dengan publik, dan meningkatkan kualitas layanan pemerintah serta kesejahteraan warga. Berikut adalah enam komponen dasar dari Smart City:"
),
tags$ul(
style = "list-style-type: none; padding-left: 0;",
tags$li(
tags$b("Smart Mobility:"),
" Infrastruktur yang mendukung mobilitas cerdas, termasuk transportasi publik yang efisien dan infrastruktur jalan yang terintegrasi."
),
tags$li(
tags$b("Smart Living:"),
" Kapabilitas inovasi yang mendukung kualitas hidup warga, termasuk akses ke layanan kesehatan, pendidikan, dan perumahan yang berkualitas."
),
tags$li(
tags$b("Smart People:"),
" Peningkatan keterampilan dan edukasi warga untuk menciptakan masyarakat yang berpengetahuan dan adaptif terhadap perubahan."
),
tags$li(
tags$b("Smart Economy:"),
" Ekonomi yang stabil untuk mendorong pertumbuhan ekonomi yang berkelanjutan."
),
tags$li(
tags$b("Smart Environment:"),
" Manajemen lingkungan yang efektif, termasuk pengelolaan risiko bencana dan pelestarian sumber daya alam."
),
tags$li(
tags$b("Smart Governance:"),
" Pemerintahan yang transparan dan partisipatif, memanfaatkan teknologi untuk meningkatkan keterlibatan warga dalam proses pengambilan keputusan."
)
)
)
)
} else {
cluster_id <- as.integer(substring(input$cluster_selection, 9))
cluster_data <- data_filtered()[data_filtered()$cluster == cluster_id, ]
# Tambahkan penjelasan fokus pengembangan smart city
focus_areas <- list(
X1 = "Peningkatan Infrastruktur yang mendukung Smart Mobility.",
X2 = "Peningkatan Kapabilitas Inovasi untuk mendukung Smart Living.",
X3 = "Peningkatan Keterampilan untuk mendukung Smart People.",
X4 = "Perluasan Pasar Tenaga Kerja untuk mendukung Smart People",
X5 = "Peningkatan Stabilitas Ekonomi Makro untuk mewujudkan Smart Economy.",
X6 = "Perbaikan Manajemen Risiko Bencana yang lebih baik untuk Mewujudkan Smart Environment."
)
# Generate HTML for focus areas
significant_variables <- character()
if (cluster_id == 1) {
splinecluster1 <- uji12(0)
coefficients <- splinecluster1$Parameters
ujiT <- splinecluster1$P_Value
for (i in seq_along(coefficients)) {
# Skip first row (intercept), then process every 3 rows
if (i %% 3 != 1 && ujiT[i] <= 0.05) {
variable_index <- ceiling((i - 1) / 3)
if (!(paste0("X", variable_index) %in% significant_variables)) {
significant_variables <- c(significant_variables, paste0("X", variable_index))
}
}
}
} else if (cluster_id == 2) {
splinecluster2 <- uji23(0)
coefficients <- splinecluster2$Parameters
ujiT <- splinecluster2$P_Value
for (i in seq_along(coefficients)) {
# Skip first row (intercept), then process every 4 rows
if (i %% 4 != 1 && ujiT[i] <= 0.05) {
variable_index <- ceiling((i - 1) / 4)
if (!(paste0("X", variable_index) %in% significant_variables)) {
significant_variables <- c(significant_variables, paste0("X", variable_index))
}
}
}
} else if (cluster_id == 3) {
splinecluster3 <- uji33(0)
coefficients <- splinecluster3$Parameters
ujiT <- splinecluster3$P_Value
for (i in seq_along(coefficients)) {
# Skip first row (intercept), then process every 4 rows
if (i %% 4 != 1 && ujiT[i] <= 0.05) {
variable_index <- ceiling((i - 1) / 4)
if (!(paste0("X", variable_index) %in% significant_variables)) {
significant_variables <- c(significant_variables, paste0("X", variable_index))
}
}
}
}
focus_text <- lapply(significant_variables, function(var) {
focus_areas[[var]]
})
# Render UI dengan box dan highlight CSS
ui <- box(
title = paste("Hasil Regresi untuk Klaster", cluster_id),
status = "info",
solidHeader = TRUE,
width = 12,
div(
style = "padding: 10px; border-radius: 5px; background-color: #eafeff;",
h3("Fokus pengembangan yang dapat dilakukan untuk mewujudkan Smart City:"),
tags$ul(
style="margin-top: 0; margin-bottom: 10px;  margin-right: 40px; text-align: center;",
lapply(focus_text, function(text) {
tags$li(
style = "background: lightsteelblue; font-size: 15px; padding: 12px;
margin-bottom: 10px; border-radius: 10px; list-style: none;",
text
)
})
)
)
)
return(ui)
}
})
}
runApp()
rsconnect::deployApp(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
rsconnect::deployApp(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
deployApp()
rsconnect::deployApp()
rsconnect::deployApp()
# Fungsi untuk mengecek apakah deployment berhasil
deployAppWithRetry <- function(appDir, account, max_attempts = 5) {
attempt <- 1
success <- FALSE
while (!success && attempt <= max_attempts) {
cat("Attempt", attempt, "to deploy the app...\n")
try({
rsconnect::deployApp(appDir = appDir, account = account)
success <- TRUE
cat("Deployment successful on attempt", attempt, "!\n")
}, silent = TRUE)
if (!success) {
cat("Deployment failed on attempt", attempt, ". Retrying...\n")
attempt <- attempt + 1
Sys.sleep(10) # Wait for 10 seconds before retrying
}
}
if (!success) {
cat("Failed to deploy the app after", max_attempts, "attempts.\n")
}
}
# Panggil fungsi dengan direktori aplikasi dan akun Anda
deployAppWithRetry(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
# Fungsi untuk mengecek apakah deployment berhasil
deployAppWithRetry <- function(appDir, account, max_attempts = 20) {
attempt <- 1
success <- FALSE
while (!success && attempt <= max_attempts) {
cat("Attempt", attempt, "to deploy the app...\n")
try({
rsconnect::deployApp(appDir = appDir, account = account)
success <- TRUE
cat("Deployment successful on attempt", attempt, "!\n")
}, silent = TRUE)
if (!success) {
cat("Deployment failed on attempt", attempt, ". Retrying...\n")
attempt <- attempt + 1
Sys.sleep(10) # Wait for 10 seconds before retrying
}
}
if (!success) {
cat("Failed to deploy the app after", max_attempts, "attempts.\n")
}
}
# Panggil fungsi dengan direktori aplikasi dan akun Anda
deployAppWithRetry(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
# Set max bundle size option
options(rsconnect.max.bundle.size = 1e20)
# Set HTTP config to increase timeout
httr::set_config(httr::config(ssl_verifypeer = 1L, timeout = 100000))
rsconnect::deployApp(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
# Fungsi untuk mengecek apakah deployment berhasil
deployAppWithRetry <- function(appDir, account, max_attempts = 10) {
attempt <- 1
success <- FALSE
while (!success && attempt <= max_attempts) {
cat("Attempt", attempt, "to deploy the app...\n")
try({
rsconnect::deployApp(appDir = appDir, account = account)
success <- TRUE
cat("Deployment successful on attempt", attempt, "!\n")
}, silent = TRUE)
if (!success) {
cat("Deployment failed on attempt", attempt, ". Retrying...\n")
attempt <- attempt + 1
Sys.sleep(10) # Wait for 10 seconds before retrying
}
}
if (!success) {
cat("Failed to deploy the app after", max_attempts, "attempts.\n")
}
}
# Panggil fungsi dengan direktori aplikasi dan akun Anda
deployAppWithRetry(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
runApp()
# Panggil fungsi dengan direktori aplikasi dan akun Anda
deployAppWithRetry(
appDir = "C:/Users/mhafd/OneDrive/Documents/GitHub/EtherealSEC",
account = "mhafdal95"
)
runApp()
runApp()
runApp()
